"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=Math.PI;function r(t,r,n,a){void 0===a&&(a=!1);var i=r[0],o=n[0],u=n[1],e=o+(t-i)/(r[1]-i)*(u-o);if(!0===a)if(o<u){if(e<o)return o;if(e>u)return u}else{if(e>o)return o;if(e<u)return u}return e}function n(t,r,n,a,i){var o=Math.sin(i),u=Math.cos(i),e=t-n,h=r-a;return[e*u-h*o+n,e*o+h*u+a]}function a(t,r,n,a){return Math.hypot(a-r,n-t)}function i(t,r,n,a){return Math.atan2(a-r,n-t)}function o(t,r,n,a){return[Math.cos(n)*a+t,Math.sin(n)*a+r]}function u(t,r,n,a,i){return void 0===i&&(i=.5),[t+(n-t)*i,r+(a-r)*i]}function e(r,n){return void 0===n&&(n=8),Math.floor(n*(.5+r/(2*t)%n))}function h(r){return r-2*t*Math.floor(r/(2*t))}function f(t,r,n,a,i,o,u,e){var h,f,v;if(a*(u-i)!=n*(e-o)&&0!=(v=n*(e-o)-a*(u-i))&&(f=((r-o)*n-(t-i)*a)/v,(h=((r-o)*(u-i)-(t-i)*(e-o))/v)>=0&&f>=0&&f<=1))return[t+h*n,r+h*a]}function v(t){return[Math.cos(t),Math.sin(t)]}function M(t,r,n,a,o,u,e,v,M){var c=o+e,s=u+v,d=o+M-1,x=u+M-1,m=o+e-M+1,p=u+v-M+1,I=[[d,x,Math.PI,1.5*Math.PI],[m,x,1.5*Math.PI,2*Math.PI],[m,p,0,.5*Math.PI],[d,p,.5*Math.PI,Math.PI]],P=[];return[[o,p,o,x],[d,u,m,u],[c,x,c,p],[m,s,d,s]].forEach((function(o,u){var e=o[0],v=o[1],c=o[2],s=o[3],d=I[u],x=d[0],m=d[1],p=d[2],l=d[3],b=function(t,r,n,a,i,o,u){return function(t,r,n,a,i,o,u){var e,h,f,v,M,c,s,d,x=[o-a,u-i],m=[a-t,i-r];return e=x[0]*m[0]+x[1]*m[1],h=2*(x[0]*x[0]+x[1]*x[1]),e*=-2,f=Math.sqrt(e*e-2*h*(m[0]*m[0]+m[1]*m[1]-n*n)),isNaN(f)?[]:(M=(e+f)/h,s=[],d=[],c=[],(v=(e-f)/h)<=1&&v>=0&&(s[0]=a+x[0]*v,s[1]=i+x[1]*v,c[0]=s),M<=1&&M>=0&&(d[0]=a+x[0]*M,d[1]=i+x[1]*M,c[c.length]=d),c)}(t,r,n,a,i,999999*o,999999*u)}(x,m,M,t,r,n,a);b&&b.filter((function(t){var r=h(i(x,m,t[0],t[1]));return r>p&&r<l})).forEach((function(t){return P.push(t)}));var w=f(t,r,n,a,e,v,c,s);w&&P.push(w)})),P}function c(t,r,n,a,i,o,u,e){return function(t,r,n,a){return[[t,r,t+n,r],[t+n,r,t+n,r+a],[t+n,r+a,t,r+a],[t,r+a,t,r]]}(t,r,n,a).find((function(t){return f(i,o,u,e,t[0],t[1],t[2],t[3])}))}var s=Math.PI,d=s/24;exports.getArrow=function(t,h,f,v,M){void 0===M&&(M={});var c=M.bow,s=void 0===c?0:c,d=M.stretch,x=void 0===d?.5:d,m=M.stretchMin,p=void 0===m?0:m,I=M.stretchMax,P=void 0===I?420:I,l=M.padStart,b=void 0===l?0:l,w=M.padEnd,E=void 0===w?0:w,g=M.flip,y=void 0!==g&&g,A=M.straights,B=void 0===A||A,N=i(t,h,f,v),S=a(t,h,f,v),_=function(t,r,n,a){return Math.abs((n-t)/2/((a-r)/2))}(t,h,f,v);if(S<2*(b+E)||0===s&&0===x||B&&[0,1,Infinity].includes(_)){var j=Math.max(0,Math.min(S-b,b)),q=Math.max(0,Math.min(S-j,E)),O=o(t,h,N,j),T=O[0],k=O[1],z=o(f,v,N+Math.PI,q),C=z[0],D=z[1],F=u(T,k,C,D,.5);return[T,k,F[0],F[1],C,D,N,N,N]}var G=(e(N)%2==0?1:-1)*(y?-1:1),H=s+r(S,[p,P],[1,0],!0)*x,J=u(t,h,f,v,.5),K=J[0],L=J[1],Q=u(t,h,f,v,.5-H),R=Q[0],U=Q[1],V=n(R,U,K,L,Math.PI/2*G),W=o(t,h,i(t,h,R=V[0],U=V[1]),b),X=W[0],Y=W[1],Z=o(f,v,i(f,v,R,U),E),$=Z[0],tt=Z[1],rt=i(R,U,t,h),nt=i(R,U,f,v),at=u(X,Y,$,tt,.5),it=at[0],ot=at[1],ut=u(X,Y,$,tt,.5-H),et=ut[0],ht=ut[1],ft=n(et,ht,it,ot,Math.PI/2*G),vt=u(R,U,et=ft[0],ht=ft[1],.5);return[X,Y,vt[0],vt[1],$,tt,nt,rt,N]},exports.getBoxToBoxArrow=function(o,f,x,m,p,I,P,l,b){var w,E,g,y;void 0===b&&(b={});var A=b.bow,B=void 0===A?0:A,N=b.stretch,S=void 0===N?.25:N,_=b.stretchMin,j=void 0===_?50:_,q=b.stretchMax,O=void 0===q?420:q,T=b.padStart,k=void 0===T?0:T,z=b.padEnd,C=void 0===z?20:z,D=b.flip,F=void 0!==D&&D,G=b.straights,H=void 0===G||G,J=o-k,K=f-k,L=x+2*k,Q=m+2*k,R=p-C,U=I-C,V=P+2*C,W=l+2*C,X=o+x/2,Y=f+m/2,Z=p+P/2,$=I+l/2,tt=h(i(X,Y,Z,$)),rt=a(X,Y,Z,$);if(0===rt){var nt=X,at=K,it=Z,ot=U,ut=u(nt,at,it,ot,.5),et=ut[0],ht=ut[1],ft=i(nt,at,it,ot);return[nt,at,et,ht,it,ot,ft,ft,ft]}var vt=(e(tt)%2==0?-1:1)*(F?-1:1),Mt=function(r){return Math.abs(Math.abs(r%(t/2))-t/4)/(t/4)}(tt);Mt<1&&Mt>.85&&(Mt=.99);var ct=function(t,r,n,a,i,o,u,e){return!(t>=i+u||i>=t+n||r>=o+e||o>=r+a)}(J,K,L,Q,R,U,V,W),st=function(t,r,n,a,i,o,u,e,h,f){var v=t+n/2,c=r+a/2,s=o+e/2,d=u+h/2,x=(M(v,c,s-v,d-c,t,r,n,a,i)||[[v,c]])[0],m=x[0],p=x[1],I=(M(s,d,v-s,c-d,o,u,e,h,f)||[[s,d]])[0];return[m,p,I[0],I[1]]}(J,K,L,Q,k,R,U,V,W,C),dt=st[0],xt=st[1],mt=st[2],pt=st[3],It=a(dt,xt,mt,pt);if(!ct&&H&&Mt%.5==0){var Pt=u(dt,xt,mt,pt,.5);return[dt,xt,Pt[0],Pt[1],mt,pt,tt,tt-s,tt]}var lt=ct?r(It,[0,rt],[0,1],!0):0,bt=1-It/rt,wt=B+r(It,[j,O],[1,0],!0)*S,Et=r(Mt*Mt,[0,1],[.125*s,0],!0),gt=ct?.5*s*Mt:r(bt,[.75,1],[0,.5*s],!0)*Mt,yt=v(lt>=.5?tt+s*vt:tt+Math.max(d,gt+Et*(ct?1-lt:1))*vt),At=yt[0],Bt=yt[1],Nt=M(X,Y,At,Bt,J,K,L,Q,k)[0],St=Nt[0],_t=Nt[1],jt=c(J,K,L,Q,X,Y,At,Bt);if(!jt)throw Error;var qt=u(jt[0],jt[1],jt[2],jt[3],.5),Ot=qt[0],Tt=qt[1],kt=u(St,_t,Ot,Tt,ct?Math.max(lt,.15):.15);if(w=kt[0],E=kt[1],wt*=1+(Math.max(-2,Math.min(bt,2))*Mt-lt)/2,ct&&(wt=wt<0?Math.min(wt,-.5):Math.max(wt,.5)),lt>=.5){var zt=v(i(X,Y,Ot,Tt)),Ct=M(Z,$,zt[0],zt[1],R,U,V,W,C)[0];g=Ct[0],y=Ct[1]}else{var Dt=r(bt,[.75,1],[0,1],!0),Ft=ct?r(lt,[0,1],[0,s/8],!0):0,Gt=r(Mt*Dt,[0,1],[0,s/16],!0),Ht=v(lt>=.5?tt+s*vt:tt+s-Math.max(bt*(s/12)+(Gt+Ft)+(gt+Et)/2,d)*vt),Jt=Ht[0],Kt=Ht[1],Lt=M(Z,$,Jt,Kt,R,U,V,W,C)[0],Qt=Lt[0],Rt=Lt[1],Ut=c(R,U,V,W,Z,$,Jt,Kt);if(!Ut)throw Error;var Vt=u(Ut[0],Ut[1],Ut[2],Ut[3],.5),Wt=u(Qt,Rt,Vt[0],Vt[1],.25+.25*lt);g=Wt[0],y=Wt[1]}var Xt=u(w,E,g,y,.5),Yt=Xt[0],Zt=Xt[1],$t=u(w,E,g,y,Math.max(-1,Math.min(1,.5+wt))),tr=$t[0],rr=$t[1],nr=n(tr,rr,Yt,Zt,s/2*vt),ar=nr[0],ir=nr[1],or=n(tr,rr,Yt,Zt,s/2*-vt),ur=or[0],er=or[1],hr=ct&&a(ar,ir,Z,$)<a(ur,er,Z,$)?[ur,er]:[ar,ir],fr=hr[0],vr=hr[1],Mr=i(fr,vr,w,E);return[w,E,fr,vr,g,y,i(fr,vr,g,y),Mr,i(w,E,g,y)]};
//# sourceMappingURL=perfect-arrows.cjs.production.min.js.map
